// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql" // NeonはPostgreSQLです
  url          = env("DATABASE_URL") // .envファイルのDATABASE_URLを参照します
  relationMode = "prisma"
}

// --- 既存のTaskモデル (変更なし) ---
model Task {
  id            String   @id @default(cuid()) 
  title         String   
  timeInMinutes Int      
  createdAt     DateTime @default(now()) 
  updatedAt     DateTime @updatedAt 

  @@index([timeInMinutes]) 
}

// ★★★ テンプレート機能のための新しいモデル (ここから追加) ★★★

// 「テンプレート」の親（例: "朝のルーティン"）
model Template {
  id        String         @id @default(cuid())
  name      String         // テンプレート名 (例: "朝のルーティン")
  createdAt DateTime       @default(now())
  
  // このテンプレートが持つタスク（TemplateTask）のリスト
  tasks     TemplateTask[]
}

// 「テンプレート内のタスク」（例: "顔を洗う", "メイク"）
model TemplateTask {
  id        String   @id @default(cuid())
  title     String   // タスク名 (例: "顔を洗う")
  
  // 相対時間 (テンプレートの先頭タスクを 0 とした時の分数)
  // (例: 1番目のタスク -> 0, 2番目のタスク -> 5)
  timeOffsetInMinutes Int  
  
  // 親である Template への関連付け
  templateId String
  template   Template @relation(fields: [templateId], references: [id], onDelete: Cascade) // 親が消えたら子も消える
  
  @@index([templateId])
}